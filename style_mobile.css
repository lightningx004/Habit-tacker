/* --- Mobile Responsiveness --- */
@media (max-width: 900px) {

    html,
    body {
        height: auto;
        min-height: 100vh;
        overflow-y: auto !important;
    }

    .app-container {
        height: auto;
        min-height: 100vh;
        overflow-y: visible;
        padding: 15px;
        display: block !important;
        /* Force block to kill any flex/grid parent constraints */
    }

    .main-grid {
        display: flex !important;
        flex-direction: column !important;
        /* Force vertical stacking */
        height: auto !important;
        overflow: visible;
        gap: 30px;
        /* More space between cards */
        padding-bottom: 80px;
    }

    /* Force all cards to full width and natural height */
    .card,
    .left-panel,
    .center-panel,
    .right-panel,
    .calendar-card,
    .month-card,
    .today-focus {
        width: 100% !important;
        height: auto !important;
        min-height: auto !important;
        flex: none !important;
        margin-bottom: 0;
        max-width: none !important;
    }

    .left-panel {
        order: 2;
        /* Calendar below today */
        gap: 20px;
    }

    .center-panel {
        order: 1;
        /* Today ring first */
        margin-bottom: 20px;
    }

    .right-panel {
        order: 3;
        /* Habits last */
        min-height: 300px;
    }

    /* Resize the large ring for mobile - Removed to fix geometry/overlay issues. 250px fits fine. */
    .circular-progress {
        margin: 0 auto;
        /* Center it */
    }

    .top-bar {
        padding: 15px;
        margin-bottom: 10px;
        flex-wrap: wrap;
        gap: 10px;
    }

    h1 {
        font-size: 1.5em;
    }

    /* Calendar adjustments */
    .calendar-day {
        font-size: 1em;
        padding: 10px 0;
        height: 45px;
    }

    .calendar-card {
        padding: 20px;
    }
}

/* Drag & Drop Styles */
.sortable-ghost {
    opacity: 0.4;
    background: rgba(0, 255, 157, 0.1);
    border: 1px dashed var(--accent-neon);
}

.sortable-drag {
    cursor: grabbing;
    background: #1a1a1a;
    box-shadow: 0 0 15px var(--accent-neon);
    opacity: 1;
    transform: scale(1.02);

    /* Fix Menu Overflow & Touch Target */
    .right-panel {
        overflow: visible !important;
        /* Allow menu to pop out */
    }

    .menu-container {
        position: relative;
        z-index: 100 !important;
    }

    .icon-btn {
        padding: 15px;
        /* Larger touch area */
        z-index: 101 !important;
    }

    .dropdown-menu {
        z-index: 102 !important;
        position: absolute;
        right: 0;
        top: 100%;
        width: 200px;
    }
}